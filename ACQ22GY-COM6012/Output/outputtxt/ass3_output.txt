Conda uses environments to load different sets of Python packages
type conda env list to see the environments availible.
23/05/04 01:01:47 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
23/05/04 01:01:47 WARN SparkConf: Note that spark.local.dir will be overridden by the value set by the cluster manager (via SPARK_LOCAL_DIRS in mesos/standalone/kubernetes and LOCAL_DIRS in YARN).
23/05/04 01:01:47 INFO ResourceUtils: ==============================================================
23/05/04 01:01:47 INFO ResourceUtils: No custom resources configured for spark.driver.
23/05/04 01:01:47 INFO ResourceUtils: ==============================================================
23/05/04 01:01:47 INFO SparkContext: Submitted application: Assignment 2
23/05/04 01:01:47 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
23/05/04 01:01:47 INFO ResourceProfile: Limiting resource is cpu
23/05/04 01:01:47 INFO ResourceProfileManager: Added ResourceProfile id: 0
23/05/04 01:01:47 INFO SecurityManager: Changing view acls to: acq22gy
23/05/04 01:01:47 INFO SecurityManager: Changing modify acls to: acq22gy
23/05/04 01:01:47 INFO SecurityManager: Changing view acls groups to:
23/05/04 01:01:47 INFO SecurityManager: Changing modify acls groups to:
23/05/04 01:01:47 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(acq22gy); groups with view permissions: Set(); users  with modify permissions: Set(acq22gy); groups with modify permissions: Set()
23/05/04 01:01:47 INFO Utils: Successfully started service 'sparkDriver' on port 35621.
23/05/04 01:01:47 INFO SparkEnv: Registering MapOutputTracker
23/05/04 01:01:47 INFO SparkEnv: Registering BlockManagerMaster
23/05/04 01:01:47 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
23/05/04 01:01:47 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
23/05/04 01:01:47 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
23/05/04 01:01:47 INFO DiskBlockManager: Created local directory at /mnt/fastdata/acq22gy/blockmgr-23c06224-4024-4d26-b5b7-453bbb41cfb6
23/05/04 01:01:47 INFO MemoryStore: MemoryStore started with capacity 16.9 GiB
23/05/04 01:01:47 INFO SparkEnv: Registering OutputCommitCoordinator
23/05/04 01:01:48 WARN Utils: Service 'SparkUI' could not bind on port 4040. Attempting port 4041.
23/05/04 01:01:48 INFO Utils: Successfully started service 'SparkUI' on port 4041.
23/05/04 01:01:48 INFO Executor: Starting executor ID driver on host sharc-node174.shef.ac.uk
23/05/04 01:01:48 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''
23/05/04 01:01:48 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 41209.
23/05/04 01:01:48 INFO NettyBlockTransferService: Server created on sharc-node174.shef.ac.uk:41209
23/05/04 01:01:48 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
23/05/04 01:01:48 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, sharc-node174.shef.ac.uk, 41209, None)
23/05/04 01:01:48 INFO BlockManagerMasterEndpoint: Registering block manager sharc-node174.shef.ac.uk:41209 with 16.9 GiB RAM, BlockManagerId(driver, sharc-node174.shef.ac.uk, 41209, None)
23/05/04 01:01:48 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, sharc-node174.shef.ac.uk, 41209, None)
23/05/04 01:01:48 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, sharc-node174.shef.ac.uk, 41209, None)
+------+-------+------+----------+
|userId|movieId|rating| timestamp|
+------+-------+------+----------+
|     1|     32|   3.5|1112484819|
|     1|    367|   3.5|1112485980|
|     7|   2367|   3.0|1011206157|
|     7|   3578|   5.0|1011209161|
|    10|   2194|   4.0| 943497502|
|    11|    110|   4.0|1230853748|
|    11|   1077|   0.5|1230782602|
|    13|    380|   2.0| 849082366|
|    14|   2687|   4.5|1225310245|
|    14|   3097|   4.0|1225313966|
|    14|   3471|   4.0|1225309048|
|    16|   2396|   3.0| 990969593|
|    21|   1288|   4.0| 992189741|
|    22|    358|   3.0| 994637188|
|    22|    494|   4.0| 994638652|
|    23|    608|   5.0| 914458109|
|    23|   2424|   1.0| 914457392|
|    24|   1517|   5.0| 994232761|
|    31|   6934|   3.5|1424734567|
|    34|    231|   3.0| 839249839|
+------+-------+------+----------+
only showing top 20 rows

23/05/04 01:02:27 WARN InstanceBuilder$NativeBLAS: Failed to load implementation from:dev.ludovic.netlib.blas.JNIBLAS
23/05/04 01:02:27 WARN InstanceBuilder$NativeBLAS: Failed to load implementation from:dev.ludovic.netlib.blas.ForeignLinkerBLAS
23/05/04 01:02:28 WARN InstanceBuilder$NativeLAPACK: Failed to load implementation from:dev.ludovic.netlib.lapack.JNILAPACK
0.8 training data setting1, Root-mean-square error = 1.6853037337215189
0.8 training data setting1, MSE = 2.840248674895692
0.8 training data setting1, MAE = 1.3611070082843442
Generate top 10 movie recommendations for each user by using 0.8 split setting1:
+------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|userId|recommendations                                                                                                                                                                                               |
+------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|1     |[{82242, 5.155907}, {5436, 5.0484524}, {6279, 4.955359}, {2238, 4.8189287}, {25886, 4.7369523}, {7492, 4.681141}, {8264, 4.663838}, {31702, 4.659161}, {85179, 4.6355305}, {2585, 4.593718}]                  |
|13    |[{5436, 6.152087}, {26084, 6.022155}, {1300, 5.847036}, {5644, 5.836342}, {1941, 5.821415}, {2351, 5.803284}, {3364, 5.7643623}, {2488, 5.677398}, {82242, 5.6509295}, {8338, 5.58125}]                       |
|16    |[{91112, 3.4935126}, {5436, 3.4373856}, {5992, 3.3797686}, {5147, 3.3666494}, {123, 3.3260436}, {2442, 3.2664652}, {1176, 3.2500355}, {80041, 3.2486777}, {53355, 3.2408469}, {96829, 3.2172415}]             |
|22    |[{5440, 5.1577706}, {53355, 4.923638}, {3801, 4.6690173}, {7365, 4.655751}, {7260, 4.6500325}, {1211, 4.6426964}, {1227, 4.6401486}, {4145, 4.64011}, {6235, 4.6048174}, {2351, 4.604721}]                    |
|31    |[{82242, 5.0316267}, {86880, 4.8433433}, {2351, 4.762935}, {80417, 4.7450256}, {6279, 4.6456027}, {2238, 4.625856}, {2585, 4.5095515}, {1300, 4.502598}, {5436, 4.475803}, {52767, 4.424179}]                 |
|34    |[{2351, 3.961885}, {62137, 3.8198113}, {31702, 3.6850631}, {44657, 3.6163936}, {6857, 3.5632198}, {88129, 3.545847}, {58425, 3.545033}, {27033, 3.5134337}, {2022, 3.5050068}, {60904, 3.4970493}]            |
|44    |[{5560, 5.342876}, {5436, 5.250555}, {2937, 5.131492}, {4956, 5.0906153}, {3819, 5.0832925}, {44657, 5.03207}, {6509, 4.968943}, {1870, 4.9058566}, {4914, 4.8970695}, {4995, 4.8877497}]                     |
|47    |[{6327, 0.55493927}, {27815, 0.53296196}, {94466, 0.53167903}, {90376, 0.52300215}, {5602, 0.51973796}, {27700, 0.51509166}, {97740, 0.51221055}, {25923, 0.5085786}, {7051, 0.50256485}, {26400, 0.50144345}]|
|53    |[{2357, 3.9225574}, {82, 3.7843833}, {1237, 3.4377017}, {1412, 3.4273486}, {554, 3.4042397}, {1859, 3.3956747}, {3189, 3.3277762}, {2937, 3.3266537}, {97740, 3.2233076}, {862, 3.2041292}]                   |
|65    |[{6327, 4.3647175}, {2876, 4.1313705}, {78729, 3.8960478}, {89904, 3.883625}, {55063, 3.8310206}, {40614, 3.8093207}, {27376, 3.8029096}, {6599, 3.748253}, {5436, 3.7411525}, {3201, 3.7357395}]             |
+------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
only showing top 10 rows

0.8 training data adjusting settings2, Root-mean-square error = 3.4397725073148857
0.8 training data adjusting settings2, MSE = 11.83203490207921
0.8 training data adjusting settings2, MAE = 2.9625211875771966
Generate top 10 movie recommendations for each user by using 0.8 split setting2:
+------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|userId|recommendations                                                                                                                                                                                          |
+------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|1     |[{2303, 6.747716}, {2971, 6.7225137}, {2232, 6.7169156}, {1649, 6.439581}, {40583, 6.3167143}, {194, 6.227445}, {102445, 6.1702394}, {27317, 6.131901}, {905, 6.1286893}, {30, 6.0590677}]               |
|13    |[{40629, 6.6933613}, {53894, 6.384865}, {103249, 6.254781}, {650, 6.1666927}, {3513, 5.8086777}, {56941, 5.673976}, {549, 5.6300197}, {6957, 5.5537133}, {87232, 5.5034394}, {2333, 5.487328}]           |
|16    |[{26, 3.4988573}, {2238, 3.3236825}, {94466, 3.014735}, {2396, 2.9976473}, {955, 2.995789}, {1268, 2.9611738}, {2570, 2.904406}, {1162, 2.8488183}, {4352, 2.767907}, {91077, 2.6425145}]                |
|22    |[{6893, 9.403708}, {7024, 9.096534}, {5956, 8.777356}, {1218, 8.528577}, {43376, 8.476335}, {99114, 8.450802}, {945, 8.246189}, {5617, 8.145807}, {8042, 8.065135}, {2275, 7.9629793}]                   |
|31    |[{88129, 6.0145483}, {1218, 5.972862}, {43376, 5.7436485}, {43560, 5.684128}, {112852, 5.683808}, {53123, 5.6051497}, {4546, 5.55236}, {2970, 5.453949}, {1236, 5.430651}, {66934, 5.362478}]            |
|34    |[{1280, 5.469187}, {59387, 5.4096956}, {96610, 5.3283873}, {8117, 5.225466}, {3712, 5.1784716}, {66934, 5.167617}, {7022, 5.0685115}, {2208, 4.9879637}, {30, 4.972984}, {3198, 4.911804}]               |
|44    |[{8340, 5.254394}, {56782, 5.244129}, {2970, 5.143646}, {47099, 5.0079317}, {4995, 4.996801}, {1212, 4.8553243}, {27803, 4.850352}, {1173, 4.747701}, {112852, 4.63961}, {7980, 4.6018004}]              |
|47    |[{383, 0.49969128}, {41, 0.49672365}, {3741, 0.48308972}, {1361, 0.46783265}, {86882, 0.45601645}, {6662, 0.45460686}, {36276, 0.44509283}, {3244, 0.44159666}, {56587, 0.44060656}, {87306, 0.43868756}]|
|53    |[{2357, 3.998693}, {2203, 3.385833}, {74, 2.9640887}, {51084, 2.767175}, {927, 2.6794803}, {1147, 2.6534433}, {56782, 2.5983791}, {46723, 2.543287}, {1952, 2.5330935}, {2069, 2.490713}]                |
|65    |[{1150, 4.491593}, {30, 4.4846196}, {2905, 4.2452173}, {27376, 3.9931982}, {3735, 3.973605}, {8340, 3.9664705}, {1334, 3.914636}, {2395, 3.8997474}, {1237, 3.8526626}, {4021, 3.8465528}]               |
+------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
only showing top 10 rows

top 5 clusters with training data split 0.8:

+----------+-----+
|prediction|count|
+----------+-----+
|         2|14639|
|         5|14486|
|         4|14367|
|        10|14350|
|        18|14263|
+----------+-----+
only showing top 5 rows

====================================================
0.6 training data settings1, Root-mean-square error = 2.3742109019312347
0.6 training data settings1, MSE = 5.636877406849125
0.6 training data settings1, MAE = 1.9817114246107084
Generate top 10 movie recommendations for each user by using 0.6 split setting1:
+------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|userId|recommendations                                                                                                                                                                                      |
+------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|1     |[{2731, 5.557347}, {6731, 5.1841393}, {111759, 5.1607056}, {32149, 5.1485586}, {3169, 5.121448}, {905, 5.1005445}, {7051, 5.0680614}, {914, 5.0600457}, {8917, 5.0556912}, {1939, 4.981853}]         |
|13    |[{1913, 6.3242097}, {6237, 5.62947}, {7121, 5.5881853}, {3022, 5.5671453}, {2351, 5.3644686}, {40732, 5.359555}, {6159, 5.3574}, {2303, 5.325783}, {1227, 5.306761}, {7178, 5.3017006}]              |
|16    |[{5147, 3.4269462}, {8370, 3.3089662}, {1913, 3.2906227}, {1949, 3.188431}, {2351, 3.1374207}, {4217, 3.1110632}, {1189, 3.1066828}, {99114, 3.0915818}, {2005, 3.0612803}, {2182, 3.0519876}]       |
|22    |[{1237, 4.8833594}, {42094, 4.613696}, {112852, 4.556391}, {105468, 4.464533}, {2357, 4.407884}, {1132, 4.39579}, {2731, 4.3501835}, {8690, 4.349744}, {3060, 4.3487363}, {6773, 4.3226542}]         |
|31    |[{86880, 4.8576355}, {109569, 4.7232924}, {5177, 4.557811}, {3801, 4.522715}, {116, 4.4544396}, {3730, 4.4292545}, {3244, 4.4054403}, {2351, 4.3957396}, {68358, 4.3736515}, {86781, 4.3005376}]     |
|34    |[{94864, 3.3105862}, {27329, 3.2271852}, {2330, 3.1642575}, {91094, 3.1603441}, {45728, 3.137405}, {72405, 3.1341012}, {64839, 3.1241648}, {52579, 3.0934987}, {66097, 3.0575402}, {5903, 3.0563903}]|
|44    |[{7306, 5.6400824}, {1254, 5.1023545}, {1227, 5.075054}, {5747, 5.058115}, {3852, 4.987191}, {5121, 4.9755774}, {5292, 4.9143176}, {1365, 4.9134336}, {4995, 4.897759}, {1446, 4.8840456}]           |
|47    |[{8338, 0.5998628}, {922, 0.5530114}, {34528, 0.5330435}, {7492, 0.5284248}, {1913, 0.5147827}, {2970, 0.50043476}, {1221, 0.497688}, {4217, 0.49459913}, {26958, 0.49347305}, {2132, 0.49185717}]   |
|53    |[{2357, 3.932046}, {1551, 3.3516047}, {59143, 3.3479555}, {42094, 3.3377175}, {4278, 3.3354223}, {1132, 3.294868}, {2837, 3.2898455}, {1303, 3.267947}, {1237, 3.253141}, {55063, 3.2462168}]        |
|65    |[{64620, 4.073529}, {27376, 3.852782}, {2357, 3.769299}, {127098, 3.6111517}, {4334, 3.4970326}, {2674, 3.4533088}, {59143, 3.3774416}, {3169, 3.321233}, {58107, 3.2507498}, {2731, 3.2184532}]     |
+------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
only showing top 10 rows

0.6 training data adjusting settings2, Root-mean-square error = 3.4656212574994347
0.6 training data adjusting settings2, MSE = 12.010530700431858
0.6 training data adjusting settings2, MAE = 3.034672439417088
Generate top 10 movie recommendations for each user by using 0.6 split setting2:
+------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|userId|recommendations                                                                                                                                                                                    |
+------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|1     |[{102684, 5.5823197}, {5902, 5.5072846}, {54796, 5.0836005}, {1046, 4.984954}, {41, 4.9149375}, {3000, 4.857692}, {1446, 4.8474116}, {63082, 4.6445165}, {4014, 4.626122}, {33437, 4.5872235}]     |
|13    |[{4903, 9.056891}, {47999, 8.428012}, {1957, 8.33809}, {1251, 8.130089}, {3498, 8.068002}, {940, 8.035617}, {72737, 7.981528}, {44761, 7.76955}, {671, 7.749232}, {4239, 7.7152176}]               |
|16    |[{3095, 3.5540376}, {232, 3.0898552}, {2396, 2.9979453}, {446, 2.93598}, {4334, 2.8762634}, {1254, 2.7688797}, {1041, 2.7466822}, {2310, 2.6488626}, {26729, 2.645302}, {46723, 2.629964}]         |
|22    |[{53123, 4.526583}, {51935, 4.4472604}, {47099, 4.4349914}, {2989, 4.270226}, {8973, 4.253512}, {1974, 4.13585}, {4322, 4.048138}, {5014, 4.006746}, {494, 3.9959567}, {7360, 3.9123378}]          |
|31    |[{86880, 4.997697}, {2390, 4.8230004}, {2360, 4.6971655}, {3134, 4.6895432}, {61240, 4.4689116}, {28, 4.392182}, {7371, 4.3562055}, {39292, 4.3042064}, {232, 4.2645226}, {48082, 4.244431}]       |
|34    |[{3503, 5.1531467}, {501, 5.098099}, {3267, 4.918234}, {3152, 4.731694}, {982, 4.565859}, {2810, 4.462362}, {6900, 4.4550276}, {8833, 4.4296246}, {53996, 4.3191633}, {31804, 4.2910986}]          |
|44    |[{4995, 4.9976835}, {1188, 4.7246284}, {6773, 4.695965}, {2099, 4.55041}, {60684, 4.371797}, {3060, 4.3450184}, {43396, 4.230631}, {82, 4.086188}, {64839, 4.0529747}, {1189, 4.004293}]           |
|47    |[{1904, 0.5299776}, {61240, 0.5071212}, {383, 0.4997438}, {7256, 0.45092258}, {2138, 0.44396356}, {2973, 0.42305645}, {606, 0.41780683}, {79720, 0.4174062}, {79702, 0.41720042}, {935, 0.4155571}]|
|53    |[{2357, 3.9987957}, {52435, 3.0282624}, {93040, 2.7870185}, {123, 2.7579246}, {76093, 2.7557383}, {2973, 2.6640222}, {103341, 2.6195667}, {950, 2.5453486}, {2483, 2.5443459}, {3917, 2.5025997}]  |
|65    |[{2585, 4.4514036}, {898, 4.236866}, {65130, 4.111739}, {27376, 3.9945753}, {5508, 3.9190948}, {1238, 3.8781328}, {1635, 3.8751469}, {1209, 3.852185}, {3030, 3.838005}, {6662, 3.823786}]         |
+------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
only showing top 10 rows

top 5 clusters with training data split 0.6:

+----------+-----+
|prediction|count|
+----------+-----+
|        10| 8204|
|         2| 8166|
|        18| 7994|
|        22| 7789|
|         3| 7288|
+----------+-----+
only showing top 5 rows

0.4 training data settings1, Root-mean-square error = 2.8978915737179762
0.4 training data settings1, MSE = 8.39777557302565
0.4 training data settings1, MAE = 2.5033433219008026
Generate top 10 movie recommendations for each user by using 0.4 split setting1:
+------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|userId|recommendations                                                                                                                                                                                      |
+------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|1     |[{26366, 4.5976233}, {7924, 4.5260267}, {910, 4.4969893}, {58299, 4.3220057}, {73017, 4.3121014}, {52975, 4.226875}, {6636, 4.173733}, {55290, 4.166016}, {60684, 4.148161}, {2087, 4.10841}]        |
|13    |[{65037, 2.3357556}, {1217, 2.2261577}, {4646, 2.1864939}, {71429, 2.1692371}, {1236, 2.1460874}, {2598, 2.144205}, {965, 2.0810957}, {1226, 2.0638452}, {77364, 2.0559187}, {8338, 2.0398839}]      |
|16    |[{2066, 3.1982787}, {1812, 3.0054975}, {2396, 2.9381068}, {4508, 2.926954}, {900, 2.9143887}, {3819, 2.8921094}, {65126, 2.872884}, {7323, 2.8216424}, {947, 2.8189013}, {1303, 2.8054733}]          |
|22    |[{1490, 4.5536013}, {95449, 4.4945903}, {483, 4.4752336}, {1237, 4.3024445}, {4029, 4.2953906}, {1147, 4.281478}, {2611, 4.2402654}, {59026, 4.2360253}, {32160, 4.2235556}, {4741, 4.1337557}]      |
|31    |[{5825, 3.773367}, {7306, 3.761394}, {93040, 3.7133992}, {91529, 3.6462138}, {1959, 3.5888734}, {7924, 3.577956}, {78499, 3.5695357}, {60684, 3.557233}, {46976, 3.5323997}, {26527, 3.5279827}]     |
|34    |[{7924, 3.6278458}, {6774, 3.4090455}, {664, 3.320999}, {2289, 3.2565408}, {2193, 3.2453954}, {79720, 3.2164588}, {6573, 3.2039518}, {58299, 3.2003794}, {26366, 3.1777673}, {1757, 3.1620893}]      |
|44    |[{5147, 5.0987225}, {4037, 5.091444}, {31687, 4.9857907}, {922, 4.919109}, {213, 4.9007635}, {4995, 4.892776}, {27803, 4.8629065}, {4318, 4.7971582}, {112852, 4.7877216}, {937, 4.759234}]          |
|47    |[{2203, 0.59258187}, {3089, 0.56044936}, {383, 0.4891783}, {2842, 0.48839897}, {32460, 0.46805066}, {77658, 0.46770713}, {8337, 0.4582373}, {1419, 0.45430392}, {764, 0.45103496}, {1238, 0.4416484}]|
|65    |[{27376, 3.9349976}, {53466, 3.3823228}, {94466, 3.179455}, {89761, 3.1598747}, {51847, 3.103028}, {4428, 3.0538406}, {33463, 2.867451}, {57640, 2.7979195}, {8528, 2.780181}, {6918, 2.7649827}]    |
|78    |[{27781, 2.5523753}, {111759, 1.957898}, {3959, 1.957587}, {7445, 1.8903676}, {54256, 1.7966734}, {100507, 1.7714587}, {55726, 1.7193812}, {49220, 1.6936283}, {7924, 1.6914628}, {4446, 1.6651101}] |
+------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
only showing top 10 rows

0.4 training data adjusting settings2, Root-mean-square error = 3.3116383575912844
0.4 training data adjusting settings2, MSE = 10.966948611469983
0.4 training data adjusting settings2, MAE = 2.9348751854398176
Generate top 10 movie recommendations for each user by using 0.4 split setting2:
+------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|userId|recommendations                                                                                                                                                                                         |
+------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|1     |[{6893, 5.492546}, {949, 5.309866}, {1274, 5.2123504}, {91529, 5.1800566}, {2360, 5.129921}, {63, 5.1206336}, {1041, 4.8512316}, {104841, 4.850904}, {55820, 4.8408203}, {2087, 4.8298383}]             |
|13    |[{46723, 3.8935056}, {125, 3.8444967}, {1248, 3.5710304}, {7139, 3.451818}, {1272, 3.424402}, {5139, 3.4147406}, {70286, 3.4093945}, {1627, 3.3600028}, {3504, 3.3058724}, {5222, 3.2948494}]           |
|16    |[{1172, 3.0245457}, {2396, 2.9980884}, {1959, 2.7558813}, {5008, 2.6648426}, {7387, 2.6630595}, {1873, 2.6442933}, {1297, 2.6129642}, {2529, 2.59676}, {902, 2.569997}, {1277, 2.5420725}]              |
|22    |[{494, 3.997106}, {3062, 3.4520316}, {232, 3.4426699}, {905, 3.429464}, {79132, 3.2170198}, {3201, 3.1862302}, {8264, 3.1698377}, {106782, 3.1418488}, {358, 2.9982126}, {3089, 2.969027}]              |
|31    |[{76093, 4.5751486}, {97938, 3.974262}, {3066, 3.530799}, {5903, 3.5301867}, {6934, 3.497705}, {79091, 3.4840066}, {30816, 3.375193}, {3524, 3.2576873}, {3259, 3.2235153}, {913, 3.2055128}]           |
|34    |[{5954, 4.4569597}, {3983, 3.8637595}, {3037, 3.8634145}, {2021, 3.8396344}, {3271, 3.7303488}, {2439, 3.594377}, {98809, 3.5069544}, {7072, 3.4839509}, {1449, 3.4757812}, {2108, 3.4532666}]          |
|44    |[{4995, 4.997941}, {74458, 4.651998}, {3260, 4.451995}, {3783, 4.38033}, {678, 4.33501}, {96821, 3.9651709}, {3435, 3.9650843}, {562, 3.9297724}, {1282, 3.893538}, {81562, 3.8612628}]                 |
|47    |[{68237, 0.5148572}, {383, 0.49974382}, {3198, 0.47728983}, {1078, 0.42607325}, {96821, 0.42527673}, {5707, 0.41660756}, {8014, 0.40111712}, {26131, 0.40008497}, {1959, 0.39853466}, {5013, 0.3957712}]|
|65    |[{111759, 5.360111}, {1280, 5.266365}, {927, 5.192934}, {99114, 4.5878143}, {7445, 4.53967}, {2289, 4.435585}, {175, 4.1494074}, {3745, 4.1212196}, {3608, 4.1201553}, {40629, 4.115286}]               |
|78    |[{3196, 2.1478581}, {3959, 1.9990101}, {91529, 1.9103495}, {2009, 1.8484287}, {7263, 1.8478017}, {125, 1.8098594}, {5222, 1.7995794}, {7254, 1.7782562}, {2729, 1.76832}, {68205, 1.7591503}]           |
+------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
only showing top 10 rows

top 5 clusters with training data split 0.4:

+-----+------+-------+------+----------+-----------------+
|index|userId|movieId|rating|timestamp |features         |
+-----+------+-------+------+----------+-----------------+
|0    |1     |32     |3.5   |1112484819|[1.0,32.0,3.5]   |
|1    |1     |367    |3.5   |1112485980|[1.0,367.0,3.5]  |
|2    |7     |2367   |3.0   |1011206157|[7.0,2367.0,3.0] |
|3    |7     |3578   |5.0   |1011209161|[7.0,3578.0,5.0] |
|4    |10    |2194   |4.0   |943497502 |[10.0,2194.0,4.0]|
+-----+------+-------+------+----------+-----------------+
only showing top 5 rows

+-----------------+-----+----------+
|         features|index|prediction|
+-----------------+-----+----------+
|   [1.0,32.0,3.5]|    0|        13|
|  [1.0,367.0,3.5]|    1|        13|
| [7.0,2367.0,3.0]|    2|        13|
| [7.0,3578.0,5.0]|    3|        13|
|[10.0,2194.0,4.0]|    4|        13|
| [11.0,110.0,4.0]|    5|        13|
|[11.0,1077.0,0.5]|    6|        13|
| [13.0,380.0,2.0]|    7|        13|
|[14.0,2687.0,4.5]|    8|        13|
|[14.0,3097.0,4.0]|    9|        13|
|[14.0,3471.0,4.0]|   10|        13|
|[16.0,2396.0,3.0]|   11|        13|
|[21.0,1288.0,4.0]|   12|        13|
| [22.0,358.0,3.0]|   13|        13|
| [22.0,494.0,4.0]|   14|        13|
| [23.0,608.0,5.0]|   15|        13|
|[23.0,2424.0,1.0]|   16|        13|
|[24.0,1517.0,5.0]|   17|        13|
|[31.0,6934.0,3.5]|   18|        13|
| [34.0,231.0,3.0]|   19|        13|
+-----------------+-----+----------+
only showing top 20 rows

+----------+-----+
|prediction|count|
+----------+-----+
|        10| 8204|
|         2| 8166|
|        18| 7994|
|        22| 7789|
|         3| 7288|
+----------+-----+
only showing top 5 rows

=============PART B 2=====================
+----------+------+
|prediction|userId|
+----------+------+
|        10| 40281|
|        10| 40281|
|        10| 40281|
|        10| 40281|
|        10| 40285|
|        10| 40285|
|        10| 40285|
|        10| 40285|
|        10| 40287|
|        10| 40290|
+----------+------+
only showing top 10 rows

root
 |-- prediction: integer (nullable = true)
 |-- userId: long (nullable = true)

+----------+------+
|prediction|userId|
+----------+------+
|        10|116747|
|        10|116747|
|        10|116747|
|        10|116749|
|        10|116753|
|        10|116753|
|        10|116753|
|        10|116753|
|        10|116753|
|        10|116754|
+----------+------+
only showing top 10 rows

root
 |-- prediction: integer (nullable = true)
 |-- userId: long (nullable = true)

+----------+------+
|prediction|userId|
+----------+------+
|        10|122241|
|        10|122243|
|        10|122251|
|        10|122252|
|        10|122255|
|        10|122258|
|        10|122259|
|        10|122267|
|        10|122267|
|        10|122267|
+----------+------+
only showing top 10 rows

root
 |-- prediction: integer (nullable = true)
 |-- userId: long (nullable = true)

For the 0.8 spilt:

movies_largest_cluster:
+-------+------------------+
|movieID|       avg_ratings|
+-------+------------------+
|   1580|3.5124715193668306|
|   3175| 3.547212741751991|
|   4519| 3.112668743509865|
|   1088|3.0300791556728233|
|   1645| 3.329750432419076|
|   1959|3.5759919300605247|
|   1591|2.4985528219971056|
|   6620| 3.764760720944686|
|    471|3.6407828282828283|
|   2122|2.4642537980339587|
|   7982| 3.622516556291391|
|   8638|3.8618320610687022|
|   2366|  3.65973491773309|
|   1342| 2.981599433828733|
|   2142|2.8486140724946694|
|   5803| 2.517692307692308|
|   5300| 3.515923566878981|
|   6357| 4.007220216606498|
|   1238|3.8515240904621435|
|   3997| 2.029933481152993|
+-------+------------------+
only showing top 20 rows


top_movies:
+------+-----------------+
|    ID|      avg_ratings|
+------+-----------------+
|  6357|4.007220216606498|
| 96488| 4.06386292834891|
| 78064|4.882352941176471|
|103747|              4.0|
| 74820|4.107142857142857|
| 97186|              4.0|
| 63645|              4.0|
|130062|              4.0|
|  4101|4.454545454545454|
|115602|              4.0|
| 99817|              4.0|
| 91937|              4.0|
|   858|4.403364632237872|
| 26699|4.116666666666666|
|119907|              4.0|
|101971|4.416666666666667|
| 86181|              4.0|
| 81312|              4.0|
|   623|              4.0|
|  1303|              4.0|
+------+-----------------+
only showing top 20 rows



For the 0.6 spilt:

movies_largest_cluster:
+-------+------------------+
|movieID|       avg_ratings|
+-------+------------------+
|    471|3.5999438517686695|
|   1088|3.0279783393501805|
|   1580|3.5143425460636517|
|   3175|3.6233040702314447|
|   1342| 3.125147579693034|
|   1238| 3.888745148771022|
|   1645| 3.355257464301168|
|   1959|3.4889604415823365|
|   2122|2.6575716234652114|
|   6620|3.8028846153846154|
|   7993|3.3313253012048194|
|  96469|               4.0|
|    148|3.3333333333333335|
|   1591| 2.614396887159533|
|   2366|3.7089297886843897|
|   3918|2.9719387755102042|
|   8638|3.9139534883720932|
|   5300|3.8070866141732282|
|   4900| 2.657232704402516|
|   7982|2.8943661971830985|
+-------+------------------+
only showing top 20 rows


top_movies:
+------+-----------------+
|    ID|      avg_ratings|
+------+-----------------+
| 96469|              4.0|
| 99817|4.409090909090909|
|124861|              4.0|
| 31035|4.024647887323944|
|  5518|4.285714285714286|
| 27484|              4.0|
| 47501|              4.5|
| 88674|              5.0|
|   858|4.385127757152216|
|  3475|           4.0875|
|  7168|              4.0|
| 68544|              4.5|
| 27261|              4.0|
|  5614|4.472222222222222|
|129818|              4.0|
| 26699|              5.0|
|  6393|              4.0|
| 47935|              4.0|
|101862|              5.0|
| 63781|              4.0|
+------+-----------------+
only showing top 20 rows



For the 0.4 spilt:

movies_largest_cluster:
+-------+------------------+
|movieID|       avg_ratings|
+-------+------------------+
|   1580|3.5395408163265305|
|   3175| 3.576340564879247|
|   1591| 2.618803418803419|
|   1645|3.3237835379718055|
|   2122|        2.72578125|
|   4900|              2.76|
|   6620| 3.732929515418502|
|    471| 3.596958174904943|
|   1959|3.4739978331527626|
|   2142| 2.835236541598695|
|   4519|3.2599243856332705|
|   7240|              2.85|
|   7253| 3.642857142857143|
|   1088|2.9926358557643473|
|   1238|3.9760900140646975|
|   7982| 3.523474178403756|
|   2659|3.5064102564102564|
|  44022| 3.206642066420664|
|   8638|3.9967234600262125|
|  54190| 3.554517133956386|
+-------+------------------+
only showing top 20 rows


top_movies:
+------+-----------------+
|    ID|      avg_ratings|
+------+-----------------+
|124861|              4.0|
| 31035|4.079268292682927|
| 47084|              4.1|
| 80451|              4.0|
| 27484|              4.0|
|  6397|              4.0|
| 78064|              5.0|
| 81501|              4.0|
| 97092|              4.5|
| 89056|              4.0|
|   858|4.407995365005794|
|  3475|4.056291390728477|
| 68544|              4.5|
|  5614|4.222222222222222|
|129818|              4.0|
| 26699|4.105263157894737|
| 89506|              4.0|
| 97872|              4.5|
| 63781|              4.0|
|  8803|              4.0|
+------+-----------------+
only showing top 20 rows


The top ten most popular genres for each of the spilts are:
+------+-----+------+-----------+-------+--------+------+------+---------+---+------+
|spilts|    1|     2|          3|      4|       5|     6|     7|        8|  9|    10|
+------+-----+------+-----------+-------+--------+------+------+---------+---+------+
|     1|Drama|Comedy|Documentary|Romance|Thriller| Crime|Action|Adventure|War|Horror|
|     2|Drama|Comedy|Documentary|Romance|Thriller|Action| Crime|Adventure|War|Horror|
|     3|Drama|Comedy|Documentary|Romance|Thriller|Action| Crime|Adventure|War|Horror|
+------+-----+------+-----------+-------+--------+------+------+---------+---+------+

======================================================



